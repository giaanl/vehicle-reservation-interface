<app-main-layout>
  <div class="reservations-container">
    <div class="search-section">
      <div class="search-input-wrapper">
        <ng-icon name="heroMagnifyingGlass" class="search-icon" />
        <input
          type="text"
          class="search-input"
          placeholder="Buscar reserva"
          [ngModel]="searchQuery()"
          (ngModelChange)="onSearchChange($event)"
        />
      </div>
      <button class="filter-button" (click)="toggleFilterModal()">
        <ng-icon name="heroAdjustmentsHorizontal" />
        Filtrar
      </button>
      <button class="btn-new" (click)="openCreateModal()">
        <ng-icon name="heroPlus" />
        Nova Reserva
      </button>
    </div>

    @if (errorMessage()) {
      <div class="error-message">
        {{ errorMessage() }}
        <button class="dismiss-error" (click)="errorMessage.set('')">×</button>
      </div>
    }

    <div class="reservations-section">
      <h3 class="section-title">Últimas reservas</h3>

      @if (isLoading()) {
        <div class="loading-state">
          <p>Carregando reservas...</p>
        </div>
      } @else if (filteredReservations().length === 0) {
        <div class="empty-state">
          <ng-icon name="heroCalendar" />
          <h3>Nenhuma reserva encontrada</h3>
          <p>Crie sua primeira reserva clicando no botão acima.</p>
        </div>
      } @else {
        <div class="reservations-grid">
          @for (reservation of filteredReservations(); track reservation.id) {
            <app-reservation-card
              [reservation]="reservation"
              (cardClick)="openEditModal($event)"
            />
          }
        </div>
      }
    </div>
  </div>
</app-main-layout>

<app-reservation-modal
  [show]="showModal()"
  [reservation]="selectedReservation()"
  (close)="closeModal()"
  (save)="onSaveReservation($event)"
  (delete)="onDeleteReservation()"
/>

<app-filter-modal
  [show]="showFilterModal()"
  [filters]="filters()"
  [showStatusFilter]="true"
  (close)="toggleFilterModal()"
  (apply)="applyFilters($event)"
  (clear)="clearFilters()"
/>
